---
title: A fast interval model updating method based on MLP neural network
date: 2024-03-13 16:52:45
tags: 
categories: ModelUpdating/Interval Model Updating
---

| Title     | A fast interval model updating method based on MLP neural network |
| --------- | ----------------------------------------------------------------- |
| Author    |                                                                   |
| Conf/Jour |                                                                   |
| Year      |                                                                   |
| Project   |                                                                   |
| Paper     |                                                                   |

<!-- more -->


# Abstract

区间模型更新被广泛用于结构系统知识不足的情况。传统的区间模型更新方法依靠优化算法来更新不确定参数的区间边界。然而，这种方法存在优化时间长、无法为高维输出特性确定合适的不确定性量化指标等局限性。因此，我们提出了一种基于 MLP（多层感知器）神经网络的快速区间模型更新框架，它将已知的模型特征作为输入来预测相应的结构参数。该框架建立了一个基于 MLP 的反演代用模型，将传统方法的反演问题转化为正演问题进行解决。利用广泛的模型特征和结构参数对，通过正向计算和反向传播，最终拟合出精确的反代模型。网络训练只需要构建简单的度量指标，训练完成后的网络校正速度非常快。两个经典的数值实例--质量弹簧系统和钢板结构--证明了本文所介绍方法的可行性和有效性。


# Case

## 质量弹簧系统

### 数据集生成

#### Well-separated modes


$$\begin{aligned}
m_{1}& =1(\mathrm{kg}),\quad m_2=1(\mathrm{kg}),\quad m_3=1(\mathrm{kg});  \\
k_{3}& =k_4=1\mathrm{(N/m)},\quad k_6=3\mathrm{(N/m)};  \\
k_{1}& =k_2=k_5=[0.8,1.2]\text{(N/m).} 
\end{aligned}$$

**训练集**

- 在区间$[0,2]$内均匀生成10000组$k_1,k_2,k_3$
- 根据[Interval Identification of Structural Parameters Using Interval Deviation Degree and Monte Carlo Simulation](Interval%20Identification%20of%20Structural%20Parameters%20Using%20Interval%20Deviation%20Degree%20and%20Monte%20Carlo%20Simulation.md)，关于$\begin{aligned}\omega_1^2,\omega_2^2,\omega_3^2,\text{ and }|\varphi(1,1)|\end{aligned}$ 四个参数的二阶RSM(根据CCD(central composite design)生成15个samples)，得到10000组$\begin{aligned}\omega_1^2,\omega_2^2,\omega_3^2,\text{ and }|\varphi(1,1)|\end{aligned}$

目标：网络可以根据一组输入的$\begin{aligned}\omega_1^2,\omega_2^2,\omega_3^2,\text{ and }|\varphi(1,1)|\end{aligned}$得到对应的一组$k_1,k_2,k_3$

**实验数据集**

| 实验             | 初始区间(N/m)        | KP的*错误率*      | IRSM           | PF&RBF-NN | IRO&MC         | IDD&MC         | **本文方法**       |
| -------------- | ---------------- | ------------- | -------------- | --------- | -------------- | -------------- | -------------- |
| $[0.80, 1.20]$ | $k_1=[0.5, 1.5]$ | $[0.4,  0.0]$ | $[0.81, 1.20]$ | NAN       | $[0.79, 1.21]$ | $[0.80, 1.20]$ | $[0.80, 1.20]$ |
| $[0.80, 1.20]$ | $k_2=[0.5, 1.5]$ | $[0.8, 1.7]$  | $[0.80, 1.21]$ | NAN       | $[0.80, 1.20]$ | $[0.80, 1.19]$ | $[0.80, 1.20]$ |
| $[0.80, 1.20]$ | $k_5=[0.5, 1.5]$ | $[0.8, 1.7]$  | $[0.80, 1.20]$ | NAN       | $[0.80, 1.20]$ | $[0.80, 1.20]$ | $[0.80, 1.20]$ |
| ER             |                  |               |                | NAN       |                |                |                |
|                | $[37.5, 25]$     | $[0.4,  0.0]$ | $[1.3, 0]$     | NAN       | $[1.3, 0.8]$   | $[0, 0]$       | $[0, 0]$       |
|                | $[37.5, 25]$     | $[0.8, 1.7]$  | $[0, 0.8]$     | NAN       | $[0, 0]$       | $[0, 0.8]$     | $[0, 0]$       |
|                | $[37.5, 25]$     | $[0.8, 1.7]$  | $[0, 0]$       | NAN       | $[0, 0]$       | $[0,0]$        | $[0, 0]$       |
| **mean**       | $[37.5, 25]$     | $[0.7, 1.1]$  | $[0.4, 0.3]$   | NAN       | $[0.4, 0.3]$   | $[0, 0.3]$     | $[0, 0]$       |

#### Close modes

$$\begin{aligned}
m_{1}& =1(\mathrm{kg}),\quad m_2=4(\mathrm{kg}),\quad m_3=1(\mathrm{kg});  \\
k_{1}& =k_3=0\mathrm{(N/m)},\quad k_6=1\mathrm{(N/m)};  \\
k_{2}& =[7.5,8.5](\mathrm{N/m}),\quad k_4=k_5=[1.8,2.2](\mathrm{N/m}). 
\end{aligned}$$

**训练集**

10000组$k_2,k_4,k_5$-->10000组$\begin{aligned}\omega_1^2,\omega_2^2,\omega_3^2,\text{ and }|\varphi(1,1)|\end{aligned}$

目标：网络可以根据一组输入的$\begin{aligned}\omega_1^2,\omega_2^2,\omega_3^2,\text{ and }|\varphi(1,1)|\end{aligned}$得到对应的一组$k_2,k_4,k_5$

**实验数据集**

| 实验           | 初始区间(N/m)        | KP的*错误率*     | IRSM           | PF&RBF-NN | IRO&MC         | IDD&MC         | **本文方法**       |
| ------------ | ---------------- | ------------ | -------------- | --------- | -------------- | -------------- | -------------- |
| $[7.5, 8.5]$ | $k_2=[6.5, 9.5]$ | $[0.6, 0.7]$ | $[7.55, 8.54]$ | NAN       | $[7.48, 8.50]$ | $[7.46, 8.52]$ | $[7.50, 8.50]$ |
| $[1.8, 2.2]$ | $k_4=[1.6, 2.4]$ | $[0.8, 1.0]$ | $[1.80, 2.19]$ | NAN       | $[1.80, 2.21]$ | $[1.80, 2.20]$ | $[1.80, 2.20]$ |
| $[1.8, 2.2]$ | $k_5=[1.5, 2.4]$ | $[0.4, 0.5]$ | $[1.80, 2.20]$ | NAN       | $[1.80, 2.21]$ | $[1.81, 2.20]$ | $[1.80, 2.20]$ |
| ER           |                  |              |                | NAN       |                |                |                |
|              | $[13.3, 11.8]$   | $[0.6, 0.7]$ | $[0.7, 0.5]$   | NAN       | $[0.3, 0]$     | $[0.5, 0.2]$   | $[0, 0]$       |
|              | $[11.1, 9.1]$    | $[0.8, 1.0]$ | $[0, 0.5]$     | NAN       | $[0, 0.5]$     | $[0, 0]$       | $[0, 0]$       |
|              | $[11.1, 9.1]$    | $[0.4, 0.5]$ | $[0, 0]$       | NAN       | $[0, 0.5]$     | $[0.6, 0]$     | $[0, 0]$       |
| **mean**     | $[11.8, 10.0]$   | $[0.6, 0.7]$ | $[0.2, 0.3]$   | NAN       | $[0.1, 0.3]$   | $[0.4, 0.1]$   | $[0, 0]$       |

### 神经网络

MLP：
- 8x256
- in_dim = 4，out_dim = 3

### 实验结果

#### Well-separated modes

`python .\run.py --train --mode ws --constant_lr_iter 300 --epoch 500`
`python .\run.py --test --resume outputs\202403\@20240321-103859_ws_mlp\500_mlp.pth`
`python .\run.py --exp --resume outputs\202403\@20240321-103859_ws_mlp\500_mlp.pth`

```python
# outputs\202403\@20240321-103859_ws_mlp\500_mlp.pth
## test
error_rate_each0=:0.002073482046538083=(0.0020411959849298/0.9844290614128113)=0.21%
error_rate_each1=:0.003486005122162899=(0.0035136044025421143/1.0079171657562256)=0.35%
error_rate_each2=:0.002582641498713239=(0.002575790975242853/0.9973474740982056)=0.26%
=====================
error_rate=:0.0027195400095199776=(0.002710196888074279/0.9965644478797913)=0.27%
error_rate=:SUM([0.002073482046538083, 0.003486005122162899, 0.002582641498713239])/3==0.27%

## exp
label interval: [tensor([0.8000, 0.8012, 0.8002], device='cuda:0'),tensor([1.2000, 1.1989, 1.1991], device='cuda:0')]
out interval: [tensor([0.8003, 0.7953, 0.7988], device='cuda:0'),tensor([1.1992, 1.1966, 1.1991], device='cuda:0')]
----------------------------------------
label center: tensor([1.0000, 1.0001, 0.9996], device='cuda:0'), radius: tensor([0.2000, 0.1989, 0.1994], device='cuda:0')
out center: tensor([0.9998, 0.9960, 0.9989], device='cuda:0'), radius: tensor([0.1995, 0.2006, 0.2001], device='cuda:0')
```

#### Close modes

`python .\run.py --train --mode cl --constant_lr_iter 300 --epoch 500`
`python .\run.py --test --resume outputs\202403\@20240321-152242_cl_mlp\500_mlp.pth --mode cl`
`python .\run.py --exp --resume outputs\202403\@20240321-152242_cl_mlp\500_mlp.pth --mode cl`

```python
# outputs\202403\@20240321-152242_cl_mlp\500_mlp.pth
## test
error_rate_each0=:0.0011064511011097216=(0.00883438065648079/7.984429359436035)=0.11%
error_rate_each1=:0.00214189397007949=(0.004300745669752359/2.0079171657562256)=0.21%
error_rate_each2=:0.0009163973815933069=(0.0018303639953956008/1.9973474740982056)=0.09%
=====================
error_rate=:0.001248196127262345=(0.004988496191799641/3.9965643882751465)=0.12%
error_rate=:SUM([0.0011064511011097216, 0.00214189397007949, 0.0009163973815933069])/3==0.14%

## exp
label interval: [tensor([7.5001, 1.8012, 1.8002], device='cuda:0'),tensor([8.5000, 2.1989, 2.1991], device='cuda:0')]
out interval: [tensor([7.4970, 1.8032, 1.7999], device='cuda:0'),tensor([8.5012, 2.2038, 2.1977], device='cuda:0')]
----------------------------------------
label center: tensor([8.0000, 2.0001, 1.9996], device='cuda:0'), radius: tensor([0.4999, 0.1989, 0.1994], device='cuda:0')
out center: tensor([7.9991, 2.0035, 1.9988], device='cuda:0'), radius: tensor([0.5021, 0.2003, 0.1989], device='cuda:0')
```

## 钢板

### 数据集生成

**训练集**

Young’s modulus (E) and the shear modulus (G)

| 材料参数   | 区间均值 | 区间半径 | 区间          |
| ------ | ---- | ---- | ----------- |
| E(GPa) | 205  | 15   | $[190,220]$ |
| G(GPa) | 83   | 6    | $[77,89]$   |

在区间内生成10000组E和G，然后根据二阶RSM生成10000组的$f_1,f_2,f_3,f_4,f_5$

[Interval Identification of Structural Parameters Using Interval Deviation Degree and Monte Carlo Simulation](Interval%20Identification%20of%20Structural%20Parameters%20Using%20Interval%20Deviation%20Degree%20and%20Monte%20Carlo%20Simulation.md) 这篇论文的RSM出来的$f_4$有问题(比较明显)，其他的如$f_5$也有一点问题

`E = np.random.uniform(190.0, 220.0, 1000)`
`G = np.random.uniform(77.0, 89.0, 1000)`

```python
f1 = 13.1  + 0.2152*E - 0.01455*G - 0.0002813*E**2 - 0.0004878*E*G + 0.0006576*G**2
f2 = 44.08 + 0.5145*E - 0.1333 *G + 0.0002943*E**2 - 0.004055 *E*G + 0.005588 *G**2
f3 = 52.85 - 0.1156*E + 1.445  *G + 0.0006092*E**2 + 0.0002019*E*G - 0.005634 *G**2
f4 = 375.4 - 3.207 *E - 0.4291 *G + 0.02202  *E**2 - 0.009699 *E*G + 0.01383  *G**2
f5 = 79.55 + 0.255 *E + 2.804  *G - 0.0005059*E**2 - 0.001249 *E*G - 0.009833 *G**2
```

![image.png|666](https://raw.githubusercontent.com/qiyun71/Blog_images/main/pictures/20240321214722.png)

试试：[An interval model updating strategy using interval response surface models](An%20interval%20model%20updating%20strategy%20using%20interval%20response%20surface%20models.md)，好像差的更多

```python
f1 = 77.624    - 0.0202366  *(E-40.905  )**2 + 0.010914*(G-2.342 )**2
f2 = -2214.965 + 0.002557626*(E+955.633 )**2 + 0.099410*(G-2.274 )**2
f3 = 218.882   - 0.00043976 *(E-181.515 )**2 - 0.084119*(G-28.413)**2
f4 = 45.397    + 0.137681   *(E+37.303  )**2 + 0.35152 *(G-2.201 )**2
f5 = 1887.265  - 0.000257232*(E-2387.009)**2 - 0.139010*(G-31.986)**2
```

![image.png|666](https://raw.githubusercontent.com/qiyun71/Blog_images/main/pictures/20240322095004.png)


**实验数据集**

| 实验  | 初始区间(GPa)     | IRSM            | PF&RBF-NN       | IRO&MC           | IDD&MC           | **本文方法** |
| --- | ------------- | --------------- | --------------- | ---------------- | ---------------- | -------- |
| NAN | $E=[190,220]$ | $[196.5,203.6]$ | $[196.1,204.9]$ | $[196.2, 204.8]$ | $[196.2, 204.8]$ |          |
| NAN | $G=[77,89]$   | $[79.5,83.4]$   | $[79.5,83.3]$   | $[79.1, 83.7]$   | $[79.2, 83.6]$   |          |

根据修正后的E和G，得到相应的$f_1,f_2,f_3,f_4,f_5$，进行对比：

| 参数    | 实验                 | 初始区间(Hz)           | IRSM(**初始不同**)     | PF&RBF-NN         | IRO&MC             | IDD&MC             | **本文方法** |
| ----- | ------------------ | ------------------ | ------------------ | ----------------- | ------------------ | ------------------ | -------- |
| $f_1$ | $[42.66, 43.64]$   | $[42.12, 45.50]$   | $[ 42.87, 43.71]$  | $[42.82,43.82]$   | $[42.81, 43.81]$   | $[42.83, 43.82]$   |          |
| $f_2$ | $[118.29, 121.03]$ | $[116.16, 126.62]$ | $[118.45, 121.11]$ | $[118.28,121.38]$ | $[118.28, 121.38]$ | $[118.29, 121.38]$ |          |
| $f_3$ | $[133.24, 136.54]$ | $[131.48, 141.32]$ | $[133.58, 136.79]$ | $[133.60,136.73]$ | $[133.25, 137.05]$ | $[133.36, 136.96]$ |          |
| $f_4$ | $[234.07, 239.20]$ | $[227.77, 250.55]$ | $[232.78, 238.78]$ | $[232.28,239.03]$ | $[232.25, 239.10]$ | $[232.27, 239.08]$ |          |
| $f_5$ | $[274.29, 280.64]$ | $[269.10, 289.20]$ | $[273.45, 279.86]$ | $[273.39,279.73]$ | $[272.77, 280.36]$ | $[272.96, 280.20]$ |          |
| ER：   |                    |                    |                    |                   |                    |                    |          |
| $f_1$ |                    | $[1.27, 4.26]$     | $[0.5, 0.2]$       | $[0.37, 0.41]$    | $[0.35,0.39]$      | $[0.40, 0.41]$     |          |
| $f_2$ |                    | $[1.80, 4.62]$     | $[0.1, 0.1]$       | $[0.01, 0.29]$    | $[0.01,0.29]$      | $[0.00, 0.29]$     |          |
| $f_3$ |                    | $[1.32, 3.50]$     | $[0.3, 0.2]$       | $[0.27, 0.14]$    | $[0.01,0.37]$      | $[0.09, 0.31]$     |          |
| $f_4$ |                    | $[2.69, 4.74]$     | $[0.6, 0.2]$       | $[0.76, 0.07]$    | $[0.78,0.04]$      | $[0.77, 0.05]$     |          |
| $f_5$ |                    | $[1.89, 3.05]$     | $[0.3, 0.3]$       | $[0.33, 0.32]$    | $[0.55,0.10]$      | $[0.48, 0.16]$     |          |
| mean  |                    | $[1.79, 4.03]$     | $[0.4, 0.2]$       | $[0.35, 0.25]$    | $[0.34,0.24]$      | $[0.35, 0.24]$     |          |

### 实验结果

`python .\run.py --train --constant_lr_iter 300 --epoch 500`
`python .\run.py --test --resume path_of_pth`
`python .\run.py --exp --resume path_of_pth`

```python
# 
## test


## exp

```

